<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Yuvi Panda" />
<meta property="og:description" content="Jupyter | Kubernetes | Wikimedia" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://words.yuvi.in/" />



<meta property="og:updated_time" content="2013-08-01T16:51:09&#43;00:00"/>










<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Yuvi Panda"/>
<meta name="twitter:description" content="Jupyter | Kubernetes | Wikimedia"/>
<meta name="generator" content="Hugo 0.31.1" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Blog",
  "headline": "Yuvi Panda",
  "url" : "http://words.yuvi.in/",
  "author": {
    "@type": "Person",
    "name": ""
  },
  "dateModified": "2013-08-01T16:51:09&#43;00:00",
  "keywords": "books,class-notes,code,devlog,education,events,links,lol-culture,papers,personal,so-called-it,uncategorized,wiki,algorithm,android,anniversary,answers,athiesm,atleast-not-yet,bigco,bigotry,binder,blogging,book,code,crime,democratizing-programming,devlog,devlog-dec-2011,education,external-enforcement,fiction,flipkart,india,interview,it,js,learning,link,linux,note-to-future-self,opensource,parenting,personal,photo,photography,php,python,rant,reddit,reprint,resistance,review,rights,sick,sriram,systemd,talk,talks,travel,twitter,wordpress,work,yahoo,",
  "description": "Jupyter | Kubernetes | Wikimedia"
}
</script>


    <link rel="canonical" href="http://words.yuvi.in/">

    <title>Yuvi Panda</title>

    <!-- combined, minified CSS -->
    <link href="http://words.yuvi.in/css/style.css" rel="stylesheet" integrity="sha384-O8wjsnz02XiyrPxnhfF6AVOv6YLBaEGRCnVF&#43;DL3gCPBy9cieyHcpixIrVyD2JS5" crossorigin="anonymous">

    
    <!-- RSS 2.0 feed -->
    <link href="http://words.yuvi.in/index.xml" rel="alternate" type="application/rss+xml" title="Yuvi Panda" />
    

    

    

    

  </head>

  <body>

    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link active" href="http://words.yuvi.in/">Home</a>
          
          
        </nav>
      </div>
    </div>

    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title">
            
            <img src='/profile.jpg' width=80 style="border-radius: 50%; margin-bottom: 12px;">
            <a href="http://words.yuvi.in/" rel="home">Yuvi Panda</a></h1>
        <p class="lead blog-description">Jupyter | Kubernetes | Wikimedia</p>
      </div>
    </header>

    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          







<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://words.yuvi.in/die-80-cols-or-die-guidelines/">Die ’80 cols or die!’ guidelines!</a></h2>
    <p class="blog-post-meta"><time datetime="2013-08-01T16:51:09Z">Thu Aug 1, 2013</time> by yuvipanda in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/code" rel="category tag">code</a>, <a href="/categories/links" rel="category tag">links</a>


</p>
  </header>
  <p>Python&rsquo;s <a href="http://www.python.org/dev/peps/pep-0008/">PEP8</a> has just been <a href="http://hg.python.org/peps/rev/fb24c80e9afb">changed</a> to no longer recommend sticking to 79 columns! The new text says:</p>

<pre><code>Aim to limit all lines to a maximum of 79 characters, but up to 99 characters is acceptable when it improves readability.
</code></pre>

<p>It would be nice to not have any such set limits at all, and just depend on programmers not being insane, but this is still an improvement!</p>

</article> 






<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://words.yuvi.in/sprinkling-some-douchebaginess-in-code/">Sprinkling some Douchebaginess in code</a></h2>
    <p class="blog-post-meta"><time datetime="2013-07-30T08:49:24Z">Tue Jul 30, 2013</time> by yuvipanda in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/code" rel="category tag">code</a>, <a href="/categories/links" rel="category tag">links</a>


</p>
  </header>
  <p>After being frustrated at Java&rsquo;s lack of a generic &lsquo;callback&rsquo; type, I created this interface:</p>

<pre><code>    public interface ContributionUploadProgress {
        void onUploadStarted(Contribution contribution);
        boolean isJavaAPieceOfShit();
    }
</code></pre>

<p>And randomly throw around (with <code>onComplete</code> implementing <code>ContributionUploadProgress</code>)</p>

<pre><code>    assert onComplete.isJavaAPieceOfShit();
</code></pre>

<p>This, of course, is trivial to fix with an IDE. Should be more fun with a dynamic language :)</p>

<p>(And yes, I removed that code before committing)</p>

</article> 






<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://words.yuvi.in/nitpicking-about-the-order-of-cards/">Nitpicking about the Order of Cards</a></h2>
    <p class="blog-post-meta"><time datetime="2013-07-29T01:18:42Z">Mon Jul 29, 2013</time> by yuvipanda in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/code" rel="category tag">code</a>, <a href="/categories/links" rel="category tag">links</a>, <a href="/categories/wiki" rel="category tag">wiki</a>


</p>
  </header>
  <p>Someone pointed out <a href="https://gerrit.wikimedia.org/r/#/c/76342/4/wmf-config/InitialiseSettings.php">this</a> happening on Gerrit&#8230;</p>

</article> 






<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://words.yuvi.in/github-streaks/">GitHub Streaks</a></h2>
    <p class="blog-post-meta"><time datetime="2013-07-27T22:41:11Z">Sat Jul 27, 2013</time> by yuvipanda in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/links" rel="category tag">links</a>, <a href="/categories/personal" rel="category tag">personal</a>


</p>
  </header>
  <p>I&rsquo;m on my <a href="https://github.com/yuvipanda">longest</a> GitHub Streak this year &#8211; currently 20 days (was previously 18 days). That means I&rsquo;ve had at least one commit (though usually more!) each day for the last 20 days. Sounds much easier than it actually is. Wanting to keep my streak unbroken is also making me write more diverse code &#8211; I think those 20 days feature code in Javascript, Python, Java, PHP and Python. It&rsquo;s also distributed across a lot of projects &#8211; at least 8-9 different ones on last count. Streaks are helping me a fair bit! Getting the first commit of the day is the hardest &#8211; seems to get easier to keep things after.</p>

<p>So I&rsquo;ve beat my previous streak length for this year (18 days). Next step would be to get over the awesome/scarily productive <a href="https://github.com/legoktm">legoktm</a>&rsquo;s longest streak (29 days). Eventual goal would be to match <a href="https://github.com/atdt">ori-l</a> at some point in productivity.</p>

</article> 






<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://words.yuvi.in/game-of-life-in-apl/">Game of Life in APL</a></h2>
    <p class="blog-post-meta"><time datetime="2013-07-25T10:52:05Z">Thu Jul 25, 2013</time> by yuvipanda in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/code" rel="category tag">code</a>, <a href="/categories/links" rel="category tag">links</a>


</p>
  </header>
  <p>Ran across a video explaining <a href="https://www.youtube.com/watch?v=a9xAKttWgP4">building Game of Life in APL</a>. Pretty awesome, and surprisingly &#8211; quite understandable too!</p>

<p>I should learn <a href="http://www.jsoftware.com/">J</a> at some point, I think. My problem with trying to learn such languages is that I find it hard to find something to build that&rsquo;s not a mere academic exercise, and I still do not have a solution as such. Just &lsquo;try harder&rsquo; doesn&rsquo;t really work. Perhaps invent some sort of wonderful number crunching idea and then implement it?</p>

</article> 






<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://words.yuvi.in/cant-take-the-india-out-of-the-w3c/">Can’t take the India out of the W3C…</a></h2>
    <p class="blog-post-meta"><time datetime="2013-07-24T07:12:12Z">Wed Jul 24, 2013</time> by yuvipanda in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/links" rel="category tag">links</a>, <a href="/categories/so-called-it" rel="category tag">so-called-IT</a>


</p>
  </header>
  <p>Presenting, the <a href="http://www.w3cindia.in/HTML5-tour-2013/index.html">W3C India website</a>, <em>apparently</em> from 2013. Funniest bit was probably:</p>

<blockquote>
<p>Best view in IE 9+, latest version of chrome, mozilla, opera and safari.</p>
</blockquote>

<p>Number of interactions with <a href="http://cdac.in/">CDAC</a> that have given me faith in any semblance of their competence: 0</p>

</article> 






<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://words.yuvi.in/first-major-feature-to-commons-deployed/">First major feature to Commons deployed</a></h2>
    <p class="blog-post-meta"><time datetime="2013-07-23T00:40:26Z">Tue Jul 23, 2013</time> by yuvipanda in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/code" rel="category tag">code</a>, <a href="/categories/devlog" rel="category tag">devlog</a>, <a href="/categories/wiki" rel="category tag">wiki</a>


</p>
  </header>
  <p>My <a href="https://mediawiki.org/wiki/User:Yuvipanda/Campaigns_namespace_proposal">UploadWizard work</a> has just been deployed to <a href="https://commons.wikimedia.org">Wikimedia Commons</a> and my name is listed in the on site <a href="https://commons.wikimedia.org/wiki/Special:Version">credits</a>. Special thanks to <a href="http://marktraceur.info/">Mark Traceur</a> for code review!</p>

<p>This feels very, <em>very</em> nice :) Now to sneak more code into other extensions&#8230;</p>

</article> 






<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://words.yuvi.in/bikeshedding-on-gerrit-1/">Bikeshedding on Gerrit #1</a></h2>
    <p class="blog-post-meta"><time datetime="2013-07-22T14:00:17Z">Mon Jul 22, 2013</time> by yuvipanda in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/code" rel="category tag">code</a>, <a href="/categories/wiki" rel="category tag">wiki</a>


</p>
  </header>
  <p>First there was <a href="https://gerrit.wikimedia.org/r/#/c/74079/">this</a>.</p>

<p>I was bored, and so there was <a href="https://gerrit.wikimedia.org/r/#/c/75056/">this</a>. That of course, brought a swift end to the bikeshed. I&rsquo;m only <em>slightly</em> ashamed.</p>

</article> 






<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://words.yuvi.in/god-biological-engineering-and-friendly-ais/">God, biological engineering and friendly AIs</a></h2>
    <p class="blog-post-meta"><time datetime="2013-07-21T18:09:58Z">Sun Jul 21, 2013</time> by yuvipanda in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/links" rel="category tag">links</a>


</p>
  </header>
  <p><a href="http://www.fullmoon.nu/articles/art.php?id=tal">Talking to God</a> is an interesting piece about apparent &lsquo;dangers&rsquo; of knowledge and the necessary side effects of evolution. Thought provoking.</p>

</article> 






<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://words.yuvi.in/attempting-to-secure-redis-in-a-multi-tenant-environment/">Attempting to Secure Redis in a Multi Tenant environment</a></h2>
    <p class="blog-post-meta"><time datetime="2013-07-20T23:48:43Z">Sat Jul 20, 2013</time> by yuvipanda in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/code" rel="category tag">code</a>, <a href="/categories/devlog" rel="category tag">devlog</a>, <a href="/categories/wiki" rel="category tag">wiki</a>


</p>
  </header>
  

<p>When running <a href="http://redis.io/">Redis</a> in a shared cluster/hosting environment (such as <a href="https://wikitech.wikimedia.org/wiki/Nova_Resource:Tools/Help">Wikimedia Tool Labs</a>, on which I&rsquo;ve been having fun doing a lot of work on), you would want to try to provide at least <em>some</em> guarantee of isolation for your keys from everyone else&rsquo;s keys. Since Redis doesn&rsquo;t do ACLs, this is problematic.</p>

<p>This can be solved in a couple of ways</p>

<h2 id="run-a-redis-instance-for-each-user">Run a Redis instance for each user</h2>

<p>This is simple enough to do &#8211; each user runs their own Redis instance, and has full access to it. Security is handled by setting a secret password, and running <code>redis-server</code> as the user in question. Boom, secure!</p>

<p>This doesn&rsquo;t really scale with a large number of users, because they each have lesser memory to work with now. Also having users who just want to run their tools have to deal with making sure their Redis instance is up and running fine isn&rsquo;t really good. Having the sysadmins be responsible for users&rsquo; Redis instance is&#8230; not going to work :) This would also require all the redis instances to run on one box and/or have a separate cluster just for them, which isn&rsquo;t good either.</p>

<h2 id="add-acl-support-to-redis">Add ACL support to Redis</h2>

<p>Not happening, because I&rsquo;m not good enough to do that yet :P But more realistically, it won&rsquo;t ever happen, since this will probably add a lot of overhead for what is arguably an edge case.</p>

<h2 id="build-a-small-server-that-sits-in-front-of-redis">Build a small server that sits in front of Redis</h2>

<p>Such a server would simply authenticate incoming requests via some mechanism (<a href="http://keystone.openstack.org/">Keystone</a> perhaps), and then enforce ACLs. It will have to speak the exact same protocol as Redis, since users should be able to use any library that connects to Redis. This isn&rsquo;t too hard &#8211; just replace the <code>password</code> functionality of Redis protocol to take in both a username and password (or token, or some other method of auth).</p>

<p>This also I discarded &#8211; it will still affect performance, which will now be limited by how fast <em>this</em> server runs, and that is definitely not faster than Redis. And it will also be hard to maintain, since I&rsquo;ll have to completely mimic Redis&rsquo; protocol and make sure it is kept up to date. Debugging protocol issues with random client libraries is not my idea of fun. Another <strong>major</strong> disadvantage is that <strong>I</strong> would now be writing auth code, and I don&rsquo;t think handrolling auth code is a good idea, ever.</p>

<h2 id="security-by-obscurity">Security By Obscurity!</h2>

<p>This is what we finally settled on :D It sounds horrible by the title, but I think it is Good Enough<sup>TM</sup>.</p>

<p>Since Redis is a key value store at heart, you can do anything once you know the key. So, if an &lsquo;attacker&rsquo; doesn&rsquo;t know the key, there isn&rsquo;t much they can do. So it can be considered SecureEnough for our purposes if we can make it so that other users can not find out or guess your keys.</p>

<p>We essentially did so with the following:</p>

<ol>
<li>Disable all Redis commands that let users list all / many keys.</li>
<li>Have users use a random and long key prefix for all their keys.</li>
</ol>

<p>(1) prevents someone from just listing all keys to find something interesting. (2) prevents people from brute-forcing or guessing keys. Since all code run on Tool Labs must be open source, guessing keys is super easy. By having a &lsquo;secret&rsquo; prefix, having the actual keys is useless. This also prevents accidental key overwrites from different tools using a common key name.</p>

<p>Disabling commands is easy to do by using Redis&rsquo; <code>RENAME COMMAND</code> config feature. I added support for <code>RENAME COMMAND</code> to Wikimedia&rsquo;s <a href="https://github.com/wikimedia/operations-puppet/tree/production/modules/redis">Redis puppet module</a>, and then it was simple enough to <a href="https://github.com/wikimedia/operations-puppet/blob/production/modules/toollabs/manifests/redis.pp">configure</a> a specific instance to disable &lsquo;list keys&rsquo; type commands. That&rsquo;s the following commands:</p>

<ol>
<li><code>CONFIG</code></li>
<li><code>FLUSHALL</code></li>
<li><code>FLUSHDB</code></li>
<li><code>KEYS</code></li>
<li><code>SHUTDOWN</code></li>
<li><code>SLAVEOF</code></li>
<li><code>CLIENT</code></li>
<li><code>RANDOMKEY</code></li>
<li><code>DEBUG</code>.</li>
</ol>

<p>After going through the list of Redis commands, I am guessing this is going to be GoodEnough to prevent key listing. (Note: if there&rsquo;s more that I&rsquo;m missing, please, <em>please</em> let me know).</p>

<p>We also tell people to use a secure prefix that&rsquo;s at least 64bytes long, saved in a file that is only user readable. Generating that is as simple as:</p>

<p>openssl rand -base64 64</p>

<p>That should be long enough to be hard to brute force, even with Redis being as fast as it is.</p>

<h3 id="problems">Problems</h3>

<p>The major problem with this is, of course &#8211; the fact that humans are involved :) I&rsquo;ve heard &ldquo;I do not care about my keys, do not need security&rdquo; a fair amount of times already. The fact that the prefix generation is optional means that there will be people who do not use prefixes, and it will work for them for a (probably) long time &#8211; until it doesn&rsquo;t, and they have no idea why. This is personally acceptable to me, since they have been made aware of the risks beforehand.</p>

<h2 id="fun">Fun</h2>

<p>This has now been deployed on toollabs for a month or so, and I&rsquo;ve a couple of fun tools already written using it (and other people too). We had a patched memcached server we had that we&rsquo;ll kill in a few weeks, so people who used memcached before are also migrating to redis. And I was able to do all this without even having root! This is mostly thanks to the fact that we try to keep all our configuration in puppet (<a href="https://github.com/wikimedia/operations-puppet">Wikimedia&rsquo;s Puppet repository</a>) &#8211; for both our production cluster and for everything else. So I could re-use our production redis module, make changes to it, and build the new solution &#8211; all while being vetted by &lsquo;proper&rsquo; ops people (whom I dearly love and respect). Building infrastructure in such a collaborative manner is a lot of fun, and I think I&rsquo;m hooked. It&rsquo;s fun!</p>

</article> 





<nav class="blog-pagination">
  
  <a class="btn btn-outline-primary" href="/page/7/" rel="prev" role="button">Previous page</a>
  <a class="btn btn-outline-primary" href="/page/9/" rel="next" role="button">Next page</a>
  
  
  
</nav>




        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  
  <section class="sidebar-module sidebar-module-inset">
    <h4>About</h4>
    <p><strong>Yuvi Panda</strong> is a 26 year old building infrastructure for reducing accidental complexities in solving problems with code.</p>
  </section>
  

  
        <section class="sidebar-module">
    <h4>Recent Posts</h4>
    <ol class="list-unstyled">


<li><a href="/post/why-not-s2i/">Why repo2docker? Why not s2i?</a></li>

<li><a href="/post/maintainerati-2017/">maintainerati 2017</a></li>

<li><a href="/post/designing-data-intensive-applications/">designing data intensive applications</a></li>

<li><a href="/post/think-os/">think os</a></li>

<li><a href="/post/learning-selinux/">learning selinux and apparmor</a></li>

    </ol>
  </section>

  

  
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="blog-footer">
      <p>
      
      CC0
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>

  </body>

</html>
