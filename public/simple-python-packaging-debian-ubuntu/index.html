<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Simple python packaging for Debian / Ubuntu" />
<meta property="og:description" content="(As requested by Jean-Fred)
One of the &#8216;pain points&#8217; with working on deploying python stuff at Wikimedia is that pip and virtualenvs are banned on production, for some (what I now understand as) good reasons (the solid Signing / Security issues with PYPI, and the slightly less solid but nonetheless valid &#8216;If we use pip for python and gem for ruby and npm for node, EXPLOSION OF PACKAGE MANAGERS and makes things harder to manage&#8217;)." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://words.yuvi.in/simple-python-packaging-debian-ubuntu/" />



<meta property="article:published_time" content="2014-08-19T13:08:28&#43;00:00"/>

<meta property="article:modified_time" content="2014-08-19T13:08:28&#43;00:00"/>











<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Simple python packaging for Debian / Ubuntu"/>
<meta name="twitter:description" content="(As requested by Jean-Fred)
One of the &#8216;pain points&#8217; with working on deploying python stuff at Wikimedia is that pip and virtualenvs are banned on production, for some (what I now understand as) good reasons (the solid Signing / Security issues with PYPI, and the slightly less solid but nonetheless valid &#8216;If we use pip for python and gem for ruby and npm for node, EXPLOSION OF PACKAGE MANAGERS and makes things harder to manage&#8217;)."/>
<meta name="generator" content="Hugo 0.31.1" />


    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Simple python packaging for Debian / Ubuntu",
  "url": "http://words.yuvi.in/simple-python-packaging-debian-ubuntu/",
  "wordCount": "453",
  "datePublished": "2014-08-19T13:08:28&#43;00:00",
  "dateModified": "2014-08-19T13:08:28&#43;00:00",
  "author": {
    "@type": "Person",
    "name": "yuvipanda"
  },
  "keywords": "code"
}
</script>



    <link rel="canonical" href="http://words.yuvi.in/simple-python-packaging-debian-ubuntu/">

    <title>Simple python packaging for Debian / Ubuntu | Yuvi Panda</title>

    <!-- combined, minified CSS -->
    <link href="http://words.yuvi.in/css/style.css" rel="stylesheet" integrity="sha384-O8wjsnz02XiyrPxnhfF6AVOv6YLBaEGRCnVF&#43;DL3gCPBy9cieyHcpixIrVyD2JS5" crossorigin="anonymous">

    

    
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-110578237-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>


    

    

  </head>

  <body>

    <div class="blog-masthead">
    
    </div>

    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title">
            
            <img src='/profile.jpg' width=80 style="border-radius: 50%; margin-bottom: 12px;">
            <a href="http://words.yuvi.in/" rel="home">Yuvi Panda</a></h1>
        <p class="lead blog-description"><a href="https://github.com/jupyterhub/jupyterhub">JupyterHub</a> | <a href="https://mybinder.org">MyBinder</a> | <a href="https://k8s.io">Kubernetes</a> | Open Culture</p>
      </div>
    </header>

    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://words.yuvi.in/simple-python-packaging-debian-ubuntu/">Simple python packaging for Debian / Ubuntu</a></h2>
    <p class="blog-post-meta"><time datetime="2014-08-19T13:08:28Z">Tue Aug 19, 2014</time> by yuvipanda in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/code" rel="category tag">code</a>


</p>
  </header>
  <p>(As requested by <a href="https://twitter.com/JeanFred">Jean-Fred</a>)</p>

<p>One of the &#8216;pain points&#8217; with working on deploying python stuff at Wikimedia is that <code>pip</code> and <code>virtualenvs</code> are banned on production, for some (what I now understand as) good reasons (the solid Signing / Security issues with PYPI, and the slightly less solid but nonetheless valid &#8216;If we use pip for python and gem for ruby and npm for node, EXPLOSION OF PACKAGE MANAGERS and makes things harder to manage&#8217;). I was whining about how hard debian packaging was for quite a while without checking how easy/hard it was to package python specifically, and when I finally did, it turned out to be quite not that hard.</p>

<p>Use <a href="https://pypi.python.org/pypi/stdeb">python-stdeb</a>.</p>

<p>Really, that is it. Ignore most other things (until you run into issues that require them :P). It can translate most python packages that are packaged for PyPI into .debs that mostly pass <a href="https://lintian.debian.org/">lintian</a> checks. Simplest way to package, that I&#8217;ve been following for a while is:</p>

<ol>
<li>Install <code>python-stdeb</code> (from pip or apt). Usually requires the packages <code>python-all</code>, <code>fakeroot</code> and <code>build-essential</code>, although for some reason these aren&#8217;t required by the debian package for <code>stdeb</code>. Make sure you&#8217;re on the same distro you are building the package for.</li>
<li><code>git clone</code> the package from its source</li>
<li>Run <code>python setup.py --command-packages=stdeb.command bdist_deb</code> (or <code>python3</code> if you want to make Python 3 package)</li>
<li>Run <code>lintian</code> on it. If it spots errors, go back and fix them, usually by editing the <code>setup.py</code> file (or sometimes a <code>stdeb.cfg</code> file). This is usually rather obvious and easy enough to fix.</li>
<li>Run <code>dpkg -i &lt;package&gt;</code> to try to install the package. This will error out if it can&#8217;t find the packages that your package depends on. This means that they haven&#8217;t been packaged for debian yet. You can mostly fix this by finding that package, and making a deb for it, and installing it as well (recursively making debs for packages as you need them). While this sounds onerous, the fact is that most python packages already exist as deb packages and you <code>stdeb</code> will just work for them. You might have to do this more if you&#8217;re packaging for an older distro (<em>cough</em> <em>cough</em> <code>precise</code> <em>cough</em> <em>cough</em>), but is much easier on newer distros.</li>
<li>Put your package in a repository! If you want to use this on Wikimedia Labs, you should use <a href="https://wikitech.wikimedia.org/wiki/Help:Using_debs_in_labs">Labsdebrepo</a>. Other environments will have similar ways to make the package available via <code>apt-get</code>. Avoid the temptation to just <code>dpkg -i</code> it on machines manually :)</li>
</ol>

<p>That&#8217;s pretty much it! Much simpler than I originally expected, and not much confusing / conflicting docs. The docs for <code>stdeb</code> are pretty nice and complete, so do read these!</p>

<p>Will update the post as I learn more.</p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fwords.yuvi.in%2fsimple-python-packaging-debian-ubuntu%2f" title="Share on Facebook"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://plus.google.com/share?url=http%3a%2f%2fwords.yuvi.in%2fsimple-python-packaging-debian-ubuntu%2f" title="Share on Google+"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2fwords.yuvi.in%2fsimple-python-packaging-debian-ubuntu%2f" title="Share on LinkedIn"><span class="fa fa-linkedin fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/home?status=http%3a%2f%2fwords.yuvi.in%2fsimple-python-packaging-debian-ubuntu%2f" title="Tweet this"><span class="fa fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 ml-auto blog-sidebar">
  
  <section class="sidebar-module sidebar-module-inset">
    <h4>about</h4>
    <p>I build infrastructure that helps reduce accidental complexities when using code to solve problems.</p>
  </section>
  
  <section class="sidebar-module sidebar-module-inset">
    <h4>projects</h4>
    <p><p>Primarily working on <a href="https://z2jh.jupyter.org">Zero to JupyterHub</a> and <a href="https://mybinder.org">MyBinder</a></p>

<p>See more on my <a href="https://github.com/yuvipanda">GitHub Profile</a></p>
</p>
  </section>
  
  <section class="sidebar-module sidebar-module-inset">
    <h4>work</h4>
    <p><p>I design, build &amp; operate large scale teaching infrastructure for the <a href="https://data.berkeley.edu/">Data Science Division at UC Berkeley</a>.</p>

<p>I also help run <a href="https://mybinder.org">MyBinder</a> thanks to a generous grant from the Gordon &amp; Betty Moore Foundation.</p>
</p>
  </section>
  
  <section class="sidebar-module sidebar-module-inset">
    <h4>contact</h4>
    <p><a href="mailto:yuvipanda@gmail.com">Email</a> is the best way to contact me privately.
<a href="https://twitter.com/yuvipanda">Twitter</a> is the best way to contact me publicly.</p>
  </section>
  

  
        <section class="sidebar-module">
    <h4>Recent Posts</h4>
    <ol class="list-unstyled">


<li><a href="/post/kubectl-rbac/">Kubectl verbose logging tricks</a></li>

<li><a href="/post/2017/">2017</a></li>

<li><a href="/post/why-not-s2i/">Why repo2docker? Why not s2i?</a></li>

<li><a href="/post/maintainerati-2017/">maintainerati 2017</a></li>

<li><a href="/post/designing-data-intensive-applications/">designing data intensive applications</a></li>

    </ol>
  </section>

  

  
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="blog-footer">
      <p>
      
      CC0
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>

  </body>

</html>
