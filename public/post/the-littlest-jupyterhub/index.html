<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>The Littlest Jupyterhub - Yuvi Panda</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Yuvi Panda" /><meta name="description" content="This idea comes from brainstorming along with Lindsey Heagy, Carol Willing, Tim Head &amp;amp; Nick Bollweg at the Jupyter Team Meeting 2018. Most of the good ideas are theirs! The name is inspired by one of favorite TV series of one of my favorite people.
I really love the idea of JupyterHub distributions - opinionated combination of components that target a specific use case. The Zero to JupyterHub distribution is awesome &amp;amp; works for most people." /><meta name="keywords" content="yuvi, yuvipanda" />






<meta name="generator" content="Hugo 0.70.0 with theme even" />


<link rel="canonical" href="http://words.yuvi.in/post/the-littlest-jupyterhub/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.78f8f17bab244b9ee62ad16480c9584d5fc2db06ae20681d1ca225cefd80767c.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="The Littlest Jupyterhub" />
<meta property="og:description" content="This idea comes from brainstorming along with Lindsey Heagy, Carol Willing, Tim Head &amp; Nick Bollweg at the Jupyter Team Meeting 2018. Most of the good ideas are theirs! The name is inspired by one of favorite TV series of one of my favorite people.
I really love the idea of JupyterHub distributions - opinionated combination of components that target a specific use case. The Zero to JupyterHub distribution is awesome &amp; works for most people." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://words.yuvi.in/post/the-littlest-jupyterhub/" />
<meta property="article:published_time" content="2018-06-18T13:14:59-07:00" />
<meta property="article:modified_time" content="2018-06-18T13:14:59-07:00" />
<meta itemprop="name" content="The Littlest Jupyterhub">
<meta itemprop="description" content="This idea comes from brainstorming along with Lindsey Heagy, Carol Willing, Tim Head &amp; Nick Bollweg at the Jupyter Team Meeting 2018. Most of the good ideas are theirs! The name is inspired by one of favorite TV series of one of my favorite people.
I really love the idea of JupyterHub distributions - opinionated combination of components that target a specific use case. The Zero to JupyterHub distribution is awesome &amp; works for most people.">
<meta itemprop="datePublished" content="2018-06-18T13:14:59-07:00" />
<meta itemprop="dateModified" content="2018-06-18T13:14:59-07:00" />
<meta itemprop="wordCount" content="803">



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="The Littlest Jupyterhub"/>
<meta name="twitter:description" content="This idea comes from brainstorming along with Lindsey Heagy, Carol Willing, Tim Head &amp; Nick Bollweg at the Jupyter Team Meeting 2018. Most of the good ideas are theirs! The name is inspired by one of favorite TV series of one of my favorite people.
I really love the idea of JupyterHub distributions - opinionated combination of components that target a specific use case. The Zero to JupyterHub distribution is awesome &amp; works for most people."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Yuvi Panda</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="https://github.com/yuvipanda">
        <li class="mobile-menu-item">GitHub</li>
      </a><a href="https://twitter.com/yuvipanda">
        <li class="mobile-menu-item">Twitter</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Yuvi Panda</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="https://github.com/yuvipanda">GitHub</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://twitter.com/yuvipanda">Twitter</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">The Littlest Jupyterhub</h1>

      <div class="post-meta">
        <span class="post-time"> 2018-06-18 </span>
        <div class="post-category">
            <a href="/categories/jupyter/"> jupyter </a>
            <a href="/categories/project-ideas/"> project-ideas </a>
            </div>
          <span class="more-meta"> 803 words </span>
          <span class="more-meta"> 4 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#jupyterhub-setup">JupyterHub setup</a></li>
    <li><a href="#user-environment">User environment</a></li>
    <li><a href="#configuration">Configuration</a></li>
    <li><a href="#upgrading-the-distribution">Upgrading the distribution</a></li>
    <li><a href="#installation-mechanism">Installation mechanism</a></li>
    <li><a href="#debuggability">Debuggability</a></li>
    <li><a href="#but-no-docker">But, No Docker?</a></li>
    <li><a href="#contribute">Contribute</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>This idea comes from brainstorming along with <a href="https://lindseyjh.ca/">Lindsey
Heagy</a>, <a href="https://www.willingconsulting.com/">Carol
Willing</a>, <a href="https://github.com/betatim">Tim
Head</a> &amp; <a href="https://github.com/bollwyvl">Nick
Bollweg</a> at the Jupyter Team Meeting 2018. Most
of the good ideas are theirs! The name is inspired by <a href="https://en.wikipedia.org/wiki/The_Littlest_Hobo">one of favorite TV
series</a> of one of my
favorite people.</p>
<p>I really love the idea of <a href="https://github.com/jupyterhub/jupyterhub">JupyterHub</a> distributions - opinionated combination
of components that target a specific use case. The <a href="https://z2jh.jupyter.org">Zero to JupyterHub</a>
distribution is awesome &amp; works for most people. However, it requires
<a href="https://kubernetes.io">Kubernetes</a> - a distributed system with inherent complexities that is not
worth it below a certain threshold.</p>
<p>This blog post lays out ideas for implementing a simpler, smaller distribution called
<em>The Littlest JupyterHub</em>. The Littlest JupyterHub serves <a href="https://en.wikipedia.org/wiki/Long_tail">the long tail</a> of potential JupyterHub users
who have the following needs only.</p>
<ol>
<li>Support a very small number of students (around 20â€“30, maybe 50)</li>
<li>Run on only one node, either <a href="http://digitalocean.com/">a cheap VPS</a> or a
VM on their <a href="https://cloud.google.com">favorite cloud provider</a></li>
<li>Provide the same environment for all students</li>
<li>Allow the instructor / admin to easily modify the environment for students with no specialized knowledge</li>
<li>Be extremely low maintenance once set up &amp; easily fixable when it breaks</li>
<li>Allow easy upgrades</li>
<li>Enforce memory / CPU limits for students</li>
</ol>
<p>The target audience is primarily educators teaching small classes with
Jupyter Notebooks. It should be an extremely focused distribution, with new
feature requests facing higher scrutiny than usual. It has a legitimate
chance of actually reaching 1.0 &amp; being stable, requiring minimal ongoing
upgrades!</p>
<h2 id="jupyterhub-setup">JupyterHub setup</h2>
<p>JupyterHub +
<a href="https://github.com/jupyterhub/configurable-http-proxy">ConfigurableHTTPProxy</a>
run as standard <a href="https://www.freedesktop.org/software/systemd/man/systemd.service.html">systemd services</a>.
<a href="https://github.com/jupyterhub/systemdspawner">Systemd spawner is used</a> - it is lightweight, allows JupyterHub
restarts without killing user servers &amp; provides CPU / memory isolation.</p>
<p>Something like <a href="https://github.com/yuvipanda/jupyterhub-firstuseauthenticator">First Use
Authenticator</a></p>
<ul>
<li>a user whitelist might be good enough for a large number of users. New
authenticators are added whenever users ask for them.</li>
</ul>
<p>The JupyterHub system is in its own root owned conda environment or
virtualenv, to prevent accidental damage from users.</p>
<h2 id="user-environment">User environment</h2>
<p>There is a single
conda environment shared by all the users. JupyterHub admins have
write access to this environment, and everyone else has read access. Admins
can install new libraries for all users with conda/pip. No extra steps
needed, and you can do this from inside JupyterHub without needing to ssh.</p>
<p>Each user gets their own home directory, and can install packages there if
they wish. systemdspawner puts each user server in a systemd service, and
provides <a href="https://www.freedesktop.org/software/systemd/man/systemd.resource-control.html">fine grained
control</a>
over memory &amp; cpu usage. Users also get their own system user, providing an
additional layer of security &amp; standardized home directory locations.</p>
<h2 id="configuration">Configuration</h2>
<p><a href="http://yaml.org/">YAML</a> is used for config - it is the
least bad of all the currently available languages, IMO. Ideally, something
like the <a href="https://www.sudo.ws/man/1.8.17/visudo.man.html"><code>visudo</code></a> command
would exist for editing &amp; applying this config. It&rsquo;ll
open the config file in an editor, allow users to edit it, and apply it only
if it is valid. Advanced users can sidestep this and edit files directly. The
YAML file is read and processed directly in <code>jupyterhub_config.py</code>. This
simplifies things &amp; gives us fewer things to break.</p>
<h2 id="upgrading-the-distribution">Upgrading the distribution</h2>
<p>Backwards compatible upgrading will be supported across one
minor version only - so you can go from 0.7 to 0.8, but not 0.9. Upgrades
should not cause outages.</p>
<h2 id="installation-mechanism">Installation mechanism</h2>
<p>Users run a command on a fresh server to install this distribution. This could use
conda constructor (thanks to Nick Bollweig &amp; <a href="http://matthewrocklin.com/">Matt
Rocklin</a> for convincing me!)
or debian packages (with fpm or dh-virtualenv). The user environments will be
<a href="https://conda.io/">conda environments</a>.</p>
<p>A <code>curl &lt;some-url&gt; | sudo bash</code> command is available in a
nice looking website for the distribution that users can copy paste into
their fresh VM. This website also has instructions for creating a fresh VM in
popular cloud providers &amp; VPS providers.</p>
<h2 id="debuggability">Debuggability</h2>
<p>All systems exist in a partially degraded state all the time. Good systems
self-heal &amp; continue to run as well as they can. When they can&rsquo;t, they break
cleanly in known ways. They are observable enough to debug the issues that
cause 80% of the problems.</p>
<p>The Littlest JupyterHub should be a good system. Systemd captures
logs from JupyterHub, user servers &amp; the proxy. Strong validation of the
config file catches fatal misconfigurations. Reboots actually fix most issues
and never make anything worse. Screwed up user environments are recoverable.</p>
<p>We&rsquo;ll discover how this breaks as users of varying skill levels use it, and
update our tooling accordingly.</p>
<h2 id="but-no-docker">But, No Docker?</h2>
<p>Docker has been explicitly excluded from this tech stack. Building custom
docker images &amp; dealing with registries is too complex most educators. A good
distribution embraces its constraints &amp; does well!</p>
<h2 id="contribute">Contribute</h2>
<p>Are you a person who would use a distribution like this? We would love to
hear from you! Make an issue <a href="https://github.com/yuvipanda/the-littlest-jupyterhub">on GitHub</a>,
<a href="https://twitter.com/yuvipanda">tweet at me</a>, or send me <a href="mailto:yuvipanda@gmail.com">an email</a>.</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Yuvi Panda</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2018-06-18
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      
      <nav class="post-nav">
        <a class="prev" href="/post/conda-constructor-thoughts/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Conda Constructor Thoughts</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/kubectl-rbac/">
            <span class="next-text nav-default">Kubectl verbose logging tricks</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        <div id="disqus_thread"></div>
    <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'yuvipanda';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="http://localhost:1313" class="iconfont icon--pocket" title="-pocket"></a>
      <a href="mailto:yuvipanda@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://twitter.com/yuvipanda" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://github.com/yuvipanda" class="iconfont icon-github" title="github"></a>
  <a href="http://words.yuvi.in/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2005 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Yuvi Panda</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.d7b7ada643c9c1a983026e177f141f7363b4640d619caf01d8831a6718cd44ea.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>








</body>
</html>
