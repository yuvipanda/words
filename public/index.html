<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Yuvi Panda</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Yuvi Panda" /><meta name="description" content="Blog of Yuvi Panda" /><meta name="keywords" content="yuvi, yuvipanda" />






<meta name="generator" content="Hugo 0.70.0 with theme even" />


<link rel="canonical" href="http://words.yuvi.in/" />
  <link href="http://words.yuvi.in/index.xml" rel="alternate" type="application/rss+xml" title="Yuvi Panda" />
  <link href="http://words.yuvi.in/index.xml" rel="feed" type="application/rss+xml" title="Yuvi Panda" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.78f8f17bab244b9ee62ad16480c9584d5fc2db06ae20681d1ca225cefd80767c.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Yuvi Panda" />
<meta property="og:description" content="Blog of Yuvi Panda" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://words.yuvi.in/" />
<meta property="og:updated_time" content="2020-05-17T13:59:46+05:30" />
<meta itemprop="name" content="Yuvi Panda">
<meta itemprop="description" content="Blog of Yuvi Panda"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Yuvi Panda"/>
<meta name="twitter:description" content="Blog of Yuvi Panda"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Yuvi Panda</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="https://github.com/yuvipanda">
        <li class="mobile-menu-item">GitHub</li>
      </a><a href="https://twitter.com/yuvipanda">
        <li class="mobile-menu-item">Twitter</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Yuvi Panda</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="https://github.com/yuvipanda">GitHub</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="https://twitter.com/yuvipanda">Twitter</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <section id="posts" class="posts">
    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/note-taking-part-i/">Note Taking Part I</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2020-05-17 </span>
      
        <span class="more-meta"> 1115 words </span>
        <span class="more-meta"> 6 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p>I am trying to find a nice way to keep thoughts, ideas and notes outside my head for a few months now.
I worked my way through many applications, trying to use the system they promote as the basis for my own. Along the journey, I got a better sense of what was important to me in such an application. I&rsquo;ll walk through the various applications I&rsquo;ve tried, along with the criteria I&rsquo;ve developed by the end</p>
<h2 id="evernote">Evernote</h2>
<p>First stop, big one. I already had misgivings about it being from a large corporation. I still paid for it, and tested it out for a few months.</p>
<ul>
<li>No markdown support. This immediately became a problem - I had no idea how much I&rsquo;ve come to expect markdown wherever I type. They have been <a href="https://discussion.evernote.com/topic/118932-native-markdown-support/">asked for markdown support</a> many times, but I don&rsquo;t think this is ever going to happen. I realized that <strong>markdown support is a minimum requirement</strong> for me</li>
<li>Conflict resolution when I edited the same note in multiple places was really terrible. Completely unusable. I&rsquo;ve 3 devices I use regularly - an iPad Pro, a Macbook and my Android Phone. Through this experience I discovered that <strong>proper cross-device syncing is very important</strong> for me as well.</li>
<li>I paid Evernote so I could work offline. I already have a lot of anxiety about not having internet access (a topic for another post), and didn&rsquo;t want to not have access to these if I don&rsquo;t have internet access. This wasn&rsquo;t very good thanks to the shitty conflict resolution, but the process made me realize that I cared a lot about <strong>full offline availability</strong></li>
<li>I also hated the UI. It was clunky, had way too many options, and none of the options I really wanted.</li>
<li>There was no way to link notes together I found. I realized that my time at wikimedia had made me very accustomed to hyperlinking as a way of writing. Evernote had no clear affordances for doing this. So <strong>hyperlinking</strong> became important to me. I could also smile at the big impact Wikimedia has had on the way I think :D This was the beginning of me recognizing that a purely hierarchical setup might not work for me&hellip;</li>
</ul>
<p>I noticed I was using Evernote less and less, and wandered the desert for a while.</p>
<h2 id="onenote">OneNote</h2>
<p>I had been using OneNote on and off for a while. It has some of the same problems Evernote has. But the absolute no-go for me was how it handled text notes on my laptop.</p>
<p><img src="/images/note-taking/onenote-terrible.png" alt="one note being terrible"></p>
<p>This <strong>feature</strong> killed it. It was too much mental load, and I hated the extra UI it brought. It had most of the problems evernote did, and worse.</p>
<h2 id="list-applications">List applications</h2>
<p>At this point, I read some parts of <a href="https://www.goodreads.com/book/show/1633.Getting_Things_Done">Getting Things Done</a> again, trying to control my sprawling, anxiety-filled work life. It was useful, as always, but mostly to remind me to <strong>not use my brain to store data</strong>.</p>
<p>I then spent a bunch of time bouncing between different <strong>todo list apps</strong>, as a way to get stuff out of my brain and into a list. Learning about <a href="https://www.becktench.com/blog/2019/5/13/kinder-to-do-lists">kinder todo lists</a> was very helpful.</p>
<p>I tried a lot of these apps - Google Keep, <a href="https://www.nirvanahq.com/">Nirvana</a>, Evernote / OneNote, <a href="https://ticktick.com/">TickTick</a>. Nothing really clicked, but eventually I ended up on <a href="https://todoist.com/app/">Todoist</a>. The app was great, sync worked fine, and my flatmate also used it. Boom!</p>
<p>I was still looking for a note-taking app, which I considered quite distinct from the todo list apps. I was also finding the fixed format of todoist a bit limiting. I wanted each of my Projects to have a criteria of &lsquo;this is now done&rsquo;, but there wasn&rsquo;t an easy way to do that in Todoist. The importance given to due dates was also nagging, and gave me anxiety.</p>
<h2 id="inkdrophttpswwwinkdropapp"><a href="https://www.inkdrop.app/">Inkdrop</a></h2>
<p>Looking for cross-device markdown note taking apps led me to Inkdrop. Built by a single indie dev, <a href="https://my.inkdrop.app/plugins">has lots of plugins</a>, and looked quite nice. I started using it and quite liked it in the beginning. It has a <a href="https://my.inkdrop.app/plugins/vim">vim plugin</a> which is an absolute requirement for me if I&rsquo;m going to be writing a lot of text (or so I thought)
However, I found I wasn&rsquo;t using it as much. It had all the features I thought I wanted, but somehow it wasn&rsquo;t quite fitting the mental model I had.</p>
<h2 id="outliners">Outliners</h2>
<p>At this point, I heard about <a href="https://roamresearch.com/">Roam Research</a>. It looked really neat, and was quite different from the other note taking apps. I had always dismissed <a href="https://orgmode.org/">org-mode</a> for its emacs-centrism, but this made me reconsider that. However, it was in closed beta, so I let it be. I&rsquo;ll definitely re-visit it, especially if it has a good offline story.</p>
<p>I looked around for alternatives, and discovered <a href="https://workflowy.com/">workflowey</a>. I&rsquo;ll admit the list of endorsements on their home page was a big draw for me.
However, when I tried to sign up, I got</p>
<p><img src="/images/note-taking/workflowey-password.jpg" alt="one note being terrible"></p>
<p>My usual password length is 63, and it totally <a href="https://twitter.com/WorkFlowy/status/1261034917011632128">failed that test</a>. I also discovered <a href="https://workflowy.zendesk.com/hc/en-us/community/posts/360007921026-Needs-some-kind-of-Markdown-syntax-support-">they don&rsquo;t support markdown</a> so that rules them out</p>
<h2 id="dynalist">Dynalist</h2>
<p>I discovered <strong><a href="https://dynalist.io/">Dynalist</a></strong> as a Workflowey alternative. It has all the things I want, and I&rsquo;ve been using it for a few days now. It&rsquo;s been extremely awesome! The syncing is flakey, and I have some anxiety about losing data - but otherwise, the format itself has been great for me!</p>
<p>So what I&rsquo;ve realized is that I don&rsquo;t want a note taking app, <strong>I wanted an outliner</strong>. Outliners seem to match how my brain works much better than purely hierarchical note taking apps. I can take notes without having to worry about organizing them first, and then organize them afterwards as I see fit. Very low mental overhad between what is in my brain and what&rsquo;s on the screen. I like it.</p>
<p>I hope I can replace todoist with Dynalist too. I&rsquo;ll experiment with it later. But for now, &lt;3 dynalist. This blog post was written in dynalist, then edited in <a href="https://typora.io/">typora</a>. Not bad.</p>
<h2 id="evaluation-criteria">Evaluation criteria</h2>
<p>In the end, looks like I have these needs when it comes to outliners / note taking apps.</p>
<ul>
<li>
<p>Markdown support, ideally with something like <a href="https://katex.org/">KaTeX</a> or <a href="https://www.mathjax.org/">MathJax</a> support</p>
</li>
<li>
<p>Cross-device sync across platforms (Mac, iPad, Android)</p>
</li>
<li>
<p>Full offline support, with sync that doesn&rsquo;t lose data</p>
</li>
<li>
<p>Ability to hyperlink different parts of the system</p>
</li>
</ul>
<p>I&rsquo;ll look at Roam research later, but for now, I&rsquo;m enjoying having a note taking system that matches how my brain seems to think.</p>
<h2 id="credits">Credits</h2>
<p>Lots of good conversations about this in various places with <a href="https://twitter.com/deobald">Steve Deobald</a>, <a href="https://twitter.com/prxtl">Pratul Kalia</a>, <a href="https://twitter.com/robla">Robla</a>, <a href="https://twitter.com/prtksxna">Prateek</a>, <a href="https://ankursethi.in/">Ankur Sethi</a> and many others who I am clearly forgetting.</p>
<p>Would love to hear about what you use, via <a href="mailto:yuvipanda@gmail.com">Email</a> or <a href="https://twitter.com/yuvipanda">Twitter</a>.</p>

    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/miss-blogging/">I miss blogging too</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2020-05-17 </span>
      
        <span class="more-meta"> 272 words </span>
        <span class="more-meta"> 2 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p>This person <a href="http://tttthis.com/blog/if-i-could-bring-one-thing-back-to-the-internet-it-would-be-blogs">misses blogs a lot</a>.
So do I. I made many frients, built myself a platform, and expressed myself in ways I do not feel
like I can anymore on my various blogs. Some of them are lost to time, but some are there if you know
how to find it.</p>
<p>Part of it was where my life was - I had time, nobody physically nearby I jived with, and a
<strong>lot</strong> of angst. But now, I have too little time, and too many (hah!) wonderful people I enjoy
interacting with on a 1-1 basis, nearby or not. Plus, with the death of blogging platforms
(Medium is a publishing platform, not a blogging one), content is harder to find. As the author
points out,</p>
<blockquote>
<p>The other day I searched for an hour and couldn&rsquo;t find even one. They used to be endless. You&rsquo;d just click on one you knew on Blogger and either click Blogger&rsquo;s random blog button, or go to the sidebar of the blog you knew where they always had a list of blogs they liked, sometimes four or 5, sometimes 20 other blogs. And the same with Tumbler.</p>
</blockquote>
<p><a href="https://en.wikipedia.org/wiki/Technorati">Technorati</a> is dead, and there isn&rsquo;t anything like it.
Twitter, Facebook, Instagram, Medium, etc are no replacements for long form text insight into
someone&rsquo;s lives. They have brought the internet experience to way more people, but I feel like
they have taken something away from me.</p>
<p>I guess this will be one of those blog posts that end with me saying &ldquo;I will try to blog more&rdquo;
and then there are no more posts for the next few years :)</p>

    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/devlog-2018-12-26/">Devlog 2018 12 26</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2018-12-26 </span>
      <div class="post-category">
          <a href="/categories/devlog/"> devlog </a>
          <a href="/categories/code/"> code </a>
          </div>
        <span class="more-meta"> 494 words </span>
        <span class="more-meta"> 3 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <h2 id="physical-activity">Physical activity</h2>
<p>I walked for about 6 miles yesterday evening, after doing 3-4 miles each day for about 2-3 days before. The roads were empty, and it was lovely. I&rsquo;ve listened to maybe 6-10 hours of <a href="https://en.wikipedia.org/wiki/Deborah_Frances-White">Deborah Frances-White</a> in the last week or so, split between <a href="http://guiltyfeminist.com/">The Guilty Feminist</a> and <a href="http://globalpillage.net/">Global Pillage</a>. Next time though, I&rsquo;m going to try listen to podcasts less &amp; observe my surroundings more. I am doing this (plus PT) to rehab my knee mostly. I slept for 12h yesterday night :)</p>
<h2 id="asyncio-deadlock">Asyncio deadlock</h2>
<p>I don&rsquo;t have enough experience with the pitfalls of concurrent programming where you <em>have</em> to use <a href="https://docs.python.org/3/library/asyncio-sync.html">synchronization</a> techniques. I had my first deadlock today, and after a few minutes realized it was actually an infinite recursion from a typo. I need to get a better theoretical understanding of both event loop based async programming and synchronization methods. I&rsquo;ve used them with threading &amp; Java, but feel shaky in asyncio.</p>
<p>simperviser now has 100% unit test coverage. But it combines asyncio,
processes &amp; signals - so that doesn&rsquo;t give me enough confidence as it might have otherwise. I&rsquo;ll take it though :)</p>
<h2 id="vscode-customization">VSCode customization</h2>
<p>I&rsquo;ve been re-reading the pragmatic programmer again (after initially reading it about 12 years or so ago). A lot of it still holds up, although some stuff is date (love for Broken Window policing &amp; perl). It reminded me that I hadn&rsquo;t really spent much time customizing and being more productive in VSCode, so am spending time today doing that.</p>
<p>I switch between vscode and my terminal quite a bit, mostly for git operations and running tests. I&rsquo;m going to see if I can stay inside vscode comfortably for running pytest based tests.</p>
<p>It made me very sad that the only thing I wanted from the pytest integration in vscode is something the maintainers aren&rsquo;t actively working on - <a href="https://github.com/Microsoft/vscode-python/issues/637">shortcut to run test the cursor is currently at</a>. I also can&rsquo;t seem
to see test output directly.</p>
<p>I think I&rsquo;ll be using the Terminal for pytest runs for now. I&rsquo;m not even going to try with git.</p>
<p>If I was younger and not already full of projects to do, I&rsquo;d have picked up and tried to make a PR for this. Boo time commitments.</p>
<h2 id="readyness-check">Readyness check</h2>
<p>I rallied late in the day &amp; wrote some code around readyness checks in simpervisor. I don&rsquo;t fully understand what I want it to do, but I&rsquo;m going to look at what kubernetes does &amp; try to follow that. Since this is being written for nbserverproxy, I am also going to try port nbserverproxy to simpervisor to see what kind of API affordances I&rsquo;m missing. Primarily, I feel there should be a lock somewhere, but:</p>
<ol>
<li>I don&rsquo;t have a unified theory of what needs locking &amp; why</li>
<li>I don&rsquo;t know if I need a lock or another synchronization mechanism</li>
<li>I don&rsquo;t know how it&rsquo;ll actually be used by the application</li>
</ol>
<p>So designing by porting nbserverproxy seems right.</p>

    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/devlog-2018-12-24/">Devlog 2018 12 24</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2018-12-24 </span>
      <div class="post-category">
          <a href="/categories/code/"> code </a>
          <a href="/categories/devlog/"> devlog </a>
          </div>
        <span class="more-meta"> 469 words </span>
        <span class="more-meta"> 3 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <h2 id="gracefully-exiting-asyncio-application">Gracefully exiting asyncio application</h2>
<p>Continuing yesterday&rsquo;s work on my <a href="https://github.com/yuvipanda/simpervisor">simple supervisor library</a>,
I continued trying to propagate signals cleanly to child processes
before exiting. I remembered that it isn&rsquo;t enough to just propagate
signals - you also have to actually reap them. This meant waiting
for <code>wait</code> calls on them to return.</p>
<p>I had a task running concurrently that is waiting on these
processes. So &lsquo;all&rsquo; I had to do was make sure the application
does <em>not</em> exit until these tasks are done. This turned
out to be harder than I thought! After a bunch of reading, I
recognized that what I needed to do was make sure I wait
for all pending tasks before actually exiting the application.</p>
<p>This was more involved than I thought. It also must be done
at the application level rather than in the library - you don&rsquo;t
want libraries doing sys.exit, and definitely don&rsquo;t want them
closing event loops.</p>
<p>After a bunch of looking and playing, it <em>looks</em> like what I want is
in my application code is something like:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">loop</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">get_event_loop</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">loop</span><span class="o">.</span><span class="n">run_until_complete</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">asyncio</span><span class="o">.</span><span class="n">Task</span><span class="o">.</span><span class="n">all_tasks</span><span class="p">()))</span>
        <span class="n">loop</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>This waits for all tasks to complete before exiting, and seems
to make sure all child processes are reaped. However, I have a
few unresolved questions:</p>
<ol>
<li>What happens when one of the tasks is designed to run forever,
and never exit? Should we cancel all tasks? Cancel tasks after
a timeout? Cancelling tasks after a timeout seems most
appropriate.</li>
<li>If a task schedules more tasks, do those get run? Or are they
abandoned? This seems important - can tasks keep adding more
tasks in a loop?</li>
</ol>
<p>I am getting a better handle on what people mean by &lsquo;asyncio is
more complicated than needed&rsquo;. I&rsquo;m going to find places to read
up on asyncio internals - particularly how the list of pending
tasks is maintained.</p>
<p>This <a href="https://www.roguelynn.com/words/asyncio-we-did-it-wrong-pt-1/">series of blog posts</a>
and <a href="https://www.youtube.com/watch?v=1lJDZx6f6tY">this EuroPython talk</a>
from <a href="https://www.roguelynn.com/">Lynn Root</a> helped a lot.
So did <a href="https://github.com/saghul">Saúl Ibarra Corretgé</a> (one of the asyncio core devs)
talk on <a href="https://www.youtube.com/watch?v=HppNu0-ANYw">asyncio internals</a></p>
<h3 id="testing">Testing</h3>
<p>Testing code that involves asyncio, signals and processes is
hard. I attempted to do so with <code>os.fork</code>, but decided that is
super-hard mode and I&rsquo;d rather not play. Instead, I wrote Python
code verbatim that is then spawned as a subprocess, and use
stdout to communicate back to the parent process. The child process&rsquo;
code itself is <a href="https://github.com/yuvipanda/simpervisor/blob/b130203a0a497d26f438a6ab3c9511a3c3de60ab/tests/test_atexitasync.py#L13">inline</a>
in the test file, which is terrible. I am going to move it to its
own file.</p>
<p>I also added tests for multiple signal handlers. I&rsquo;ve been writing
a lot more tests in the last few months than I was before. I credit
<a href="https://github.com/betatim">Tim Head</a> for a lot of this. It definitely
gives me a lot more confidence in my code.</p>

    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/devlog-2018-12-23/">DevLog 2018 December 23</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2018-12-23 </span>
      <div class="post-category">
          <a href="/categories/code/"> code </a>
          <a href="/categories/devlog/"> devlog </a>
          </div>
        <span class="more-meta"> 551 words </span>
        <span class="more-meta"> 3 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p>I have enjoyed keeping running logs of my coding work (devlogs)
in the past, and am going to start doing those again now.</p>
<p>This &lsquo;holiday&rsquo; season, I am spending time teaching myself
skills I sortof know about but do not have a deep understanding of.</p>
<h2 id="jupyterlab-extension">JupyterLab extension</h2>
<p>I spent the first part of the day (before I started devlogging)
working on finishing up a <a href="https://github.com/yuvipanda/jupyterlab-nbmetadata">jupyterlab extension</a>
I started the day before. It lets you <a href="https://github.com/jupyterlab/jupyterlab/issues/1308">edit notebook metadata</a>.
I got started since I wanted to use <a href="https://github.com/mwouts/jupytext">Jupytext</a>
for my work on publishing <a href="https://github.com/yuvipanda/mybinder.org-analytics">mybinder.org-analytics</a>.</p>
<p>TypeScript was easy to pick up coming from C#. I wish the
phospor / JupyterLab code had more documentation though.</p>
<p>I ran into <a href="https://github.com/jupyterlab/jupyterlab/issues/5802">a bug</a>.
While following instructions to set up a JupyterLab dev
setup, I somehow managed to <a href="https://github.com/jupyterlab/jupyterlab/issues/5803">delete my source code</a>.
Thankfully I got most of it back thanks to a saved copy
in vscode. It was a sour start to the morning though.</p>
<p>I&rsquo;ll get back on to this once the sour taste is gone,
and hopefully the bug is fixed :)</p>
<h2 id="asyncio-whats-next--yuri-selivanov--pybay-2018">asyncio: what&rsquo;s next | Yuri Selivanov @ PyBay 2018</h2>
<p>I&rsquo;ve been trying to get a better handle on asyncio. I can
use it, but I don&rsquo;t fully understand it - I am probably leaving
bugs everywhere&hellip;</p>
<!-- raw HTML omitted -->
<p>From one of the asyncio maintainers. Gave me some impetus
to <a href="https://github.com/jupyter/repo2docker/pull/539">push the default version of Python</a> on mybinder.org to 3.7 :D
I&rsquo;m most excited about getting features from Trio &amp; Curio into
the standard library. Was good to hear that nobody can quite
figure out exception handling, and not just me.</p>
<p>I discovered <a href="https://github.com/observerss/aioutils">aioutils</a>
while searching around after this. I&rsquo;ve copy pasted code that
theoretically does the same things as <code>Group</code> and <code>Pool</code> from
<code>aioutils</code>, but I&rsquo;ve no idea if they are right. I&rsquo;ll be using
this library from now!</p>
<h2 id="processing-signals">Processing Signals</h2>
<p>I&rsquo;m writing a simple process supervisor library to replace the
janky parts of nbserverproxy. It should have the following
features:</p>
<ol>
<li>Restart processes when they die</li>
<li>Propagate signals appropriately</li>
<li>Support a sense of &lsquo;readiness&rsquo; probes (not liveness)</li>
<li>Be very well tested</li>
<li>Run on asyncio</li>
</ol>
<p>This is more difficult than it seems, and am slowly working my
way through it. (1) isn&rsquo;t too difficult.</p>
<p>(2) is a fair bit more difficult. <code>atexit</code> is useless since it doesn&rsquo;t do
anything with SIGTERM. So I need to manage my own SIGTERM
handlers. However, this means there needs to be a centralish
location of some sort that decides <em>when</em> to exit. This introduces
global state, and I don&rsquo;t like that at all. But unix signals are
global, and maybe there&rsquo;s nothing for me to do here.</p>
<p>I initially created a Supervisor class that holds a bunch of
SupervisedProcess&rsquo;s, but it was still calling sys.exit in it.
Since signals are global, I realize there&rsquo;s no other real
way to handle this, and so I made a global handler setup too.
This has the additional advantage of being able to remove
handlers when a SupervisedProcess dies, avoiding memory
leaks and stuff.</p>
<p>Testing this stuff is hard!</p>
<p>I also need to make sure I don&rsquo;t end up with lots of races.
I&rsquo;m still writing concurrent code, even without threads.
Gotta be careefull. Especially with signals thrown in. Although
I guess once you get a SIGTERM or SIGINT inconsistent state
is not particularly worrysome.</p>

    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/oss-in-the-cloud/">Freedoms for Open Source Software users in the Cloud</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2018-08-15 </span>
      <div class="post-category">
          <a href="/categories/code/"> code </a>
          </div>
        <span class="more-meta"> 241 words </span>
        <span class="more-meta"> 2 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p><em>This post is from conversations with <a href="http://matthewrocklin.com/">Matt
Rocklin</a> and others at the
<a href="http://pangeo.io/">PANGEO</a> developer meeting at
<a href="https://ncar.ucar.edu/">NCAR</a></em></p>
<p>Today, almost all of &lsquo;the cloud&rsquo; is run by
ruthlessly competitive hypercapitalist large scale
organizations. This is great &amp; terrible.</p>
<p>When writing open source applications that primarily
run on the cloud, I try to make sure my users (primarily
people deploying my software for <em>their</em> users) have
the following freedoms:</p>
<ol>
<li><strong>They can run the software on any cloud provider they
choose to</strong></li>
<li><strong>They can run the software on a bunch of computers they
physically own, with the help of other open source software
only</strong></li>
</ol>
<p>Ensuring these freedoms for my users requires the following
restrictions on me:</p>
<ol>
<li>
<p>Depend on Open Source Software with hosted cloud versions,
not proprietary cloud-vendor-only software.</p>
<p>I&rsquo;ll use PostgreSQL over Google Cloud Datastore. Kubernetes with
autoscaling over talking to the EC2 api directly.</p>
</li>
<li>
<p>Use abstractions that allow swappable implementations anytime
you have to talk to a cloud provider API directly.</p>
<p>Don&rsquo;t talk to the S3 API directly, but have an abstract
interface that defines exactly what your application needs,
and then write an S3 implementation for it. Ideally, also
write a minio / ceph / file-system implementation for it,
to make sure your abstraction actually works.</p>
</li>
</ol>
<p>These are easy to follow once you are aware of them, and provide
good design tradeoffs for Open Source projects. Remember these are
necessary but not sufficient to ensure some of your users&rsquo; fundamental
freedoms.</p>

    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/aug-2018-plan/">Aug 2018 Work Plan</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2018-07-21 </span>
      <div class="post-category">
          <a href="/categories/work-plan/"> work-plan </a>
          <a href="/categories/code/"> code </a>
          </div>
        <span class="more-meta"> 543 words </span>
        <span class="more-meta"> 3 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p>I&rsquo;m writing up monthly &lsquo;work plans&rsquo; to plan what work I&rsquo;m trying to do every
month, and do a retrospective after to see how much I got done. I work across
a variety of open source projects with ambiguous responsibilities, so work
planning isn&rsquo;t very set. This has proven to be somewhat quite stressful for
everyone involved. Let&rsquo;s see if this helps!</p>
<h2 id="jupytercon-">JupyterCon</h2>
<p>JupyterCon is in NYC towards the end of August, and it is going to set the pace
for a bunch of stuff. I have 2.5-ish talks to give. Need to prepare for those and
do a good job.</p>
<h2 id="matomo-formerly-piwiki-on-mybinderorg-">Matomo (formerly Piwiki) on mybinder.org</h2>
<p>mybinder.org currently uses Google Analytics. I am not a big fan. It has troubling
privacy implications, and we don&rsquo;t get data as granularly as we want to. I am going
to try deploying <a href="https://matomo.org/">Matomo</a> (formerly Piwiki) and using that
instead. Run both together for a while and see how we like it! Matomo requires
a MySQL database &amp; is written in PHP - let&rsquo;s see how this goes ;)</p>
<h2 id="the-littlest-jupyterhub-01-release-">The Littlest JupyterHub 0.1 release</h2>
<p><a href="https://github.com/jupyterhub/the-littlest-jupyterhub">The Littlest JupyterHub</a> is
doing great! I&rsquo;ve done a <strong>lot</strong> of user tests, and the distribution has changed
drastically over time. It&rsquo;s also the first time I&rsquo;m putting my newly found
strong convictions around testing, CI &amp; documentation to practice. You can already
check it out <a href="https://github.com/jupyterhub/the-littlest-jupyterhub">on GitHub</a>. I
want to make sure we (the JupyterHub team) gets out a 0.1 release early August.</p>
<h2 id="pangeo-workshop-">Pangeo Workshop</h2>
<p>I despair about climate change and how little agency I seem to have around it
quite a bit. I&rsquo;m excited to go to the <a href="https://www2.cisl.ucar.edu/events/workshops/2018-pangeo-workshop/2018/2018-pangeo-workshop">PANGEO workshop</a>
in Colorado. I&rsquo;m mostly hoping to listen &amp; understand their world some more.</p>
<h2 id="berkeley-datahub-deployment-">Berkeley DataHub deployment</h2>
<p>Aug 20-ish is when next semester starts at UC Berkeley. I need to have a pretty
solid JupyterHub running there by then. I&rsquo;d like it to have good CI/CD set up
in a generic way, rather than something super specific to Berkeley. However,
I&rsquo;m happy to shortcut this if needed, since there&rsquo;s already so many things on
my plate haha.</p>
<h2 id="uc-davis-">UC Davis</h2>
<p>I&rsquo;m trying to spend a day or two a month at UC Davis. Partially because I like
being on Amtrak! I also think there&rsquo;s a lot of cool work happening there,
and I&rsquo;d like to hang out with all the cool people doing all the cool work.</p>
<h2 id="personal-">Personal</h2>
<p>On top of this, there&rsquo;s ongoing medical conditions to be managed. I&rsquo;m getting
Carpel Tunnel Release surgery sometime in October, so need to make sure I do
not super fuck up my hands before then. I&rsquo;m also getting a cortisone shot
for my back in early August to deal with Sciatica. Fun!</p>
<h2 id="things-im-not-doing-">Things I&rsquo;m not doing!</h2>
<p>The grading related stuff I&rsquo;ve been working on is going to the backburner
for a while. I think I bit off far more than I can chew, so time to back off.
I also do not have a good intuition for the problem domain since I&rsquo;ve never
written grading keys nor have I been a student in a class that got autograded.</p>
<h2 id="in-conclusion-">In conclusion&hellip;</h2>
<p>Shit, I&rsquo;ve a lot of things to do lol! I&rsquo;m sure I&rsquo;m forgetting some things
here that I&rsquo;ve promised people. Let&rsquo;s see how this goes!</p>

    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/conda-constructor-thoughts/">Conda Constructor Thoughts</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2018-06-28 </span>
      <div class="post-category">
          <a href="/categories/code/"> code </a>
          </div>
        <span class="more-meta"> 528 words </span>
        <span class="more-meta"> 3 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p>Inspired by conversations with <a href="https://github.com/bollwyvl">Nick Bollweg</a> and
<a href="http://matthewrocklin.com/">Matt Rocklin</a>, I experimented with using
<a href="https://github.com/conda/constructor">conda constructor</a> as the installer for
<a href="http://words.yuvi.in/post/the-littlest-jupyterhub/">The Littlest JupyterHub</a>.
Theoretically, it fit the bill perfectly - I wanted a way to ship arbitrary
packages in multiple languages (python &amp; node) in an easy to install self-contained way,
didn&rsquo;t want to make debian packages &amp; wanted to use a tool that people in the Jupyter
ecosystem were familiar with. Constructor seemed to provide just that.</p>
<p>I sortof got it working, but in the end ran into enough structural problems that
I decided it isn&rsquo;t the right tool for this job. This blog post is a note to my
future self on <em>why</em>.</p>
<p>This isn&rsquo;t a &lsquo;takedown&rsquo; of conda or conda constructor - just a particular
use case where it didn&rsquo;t work out and a demonstration of how little I know
about conda. It probably works great if you are doing more scientific computing
and less &lsquo;ship a software system&rsquo;!</p>
<h2 id="does-not-work-with-conda-forge">Does not work with <code>conda-forge</code></h2>
<p>I &lt;3 <a href="https://conda-forge.org/">conda-forge</a> and the community around
it. I know there&rsquo;s a nice <a href="https://anaconda.org/conda-forge/jupyterhub">jupyterhub</a>
package there, which takes care of installing JupyterHub, node, and required
node modules.</p>
<p>However, this doesn&rsquo;t actually work. conda constructor does not support
<a href="https://www.anaconda.com/blog/developer-blog/condas-new-noarch-packages/">noarch packages</a>,
and JupyterHub relies on several <code>noarch</code> packages. From my understanding,
more <code>conda-forge</code> packages are moving towards being <code>noarch</code> (for good reason!).</p>
<p>Looking at <a href="https://github.com/conda/constructor/issues/86">this issue</a>,
it doesn&rsquo;t look like this is a high priority item for them to fix anytime soon.
I understand that - they don&rsquo;t owe the world free work! It just makes conda
constructor a no-go for my use case&hellip;</p>
<h2 id="no-support-for-pip">No support for pip</h2>
<p>You can pip install packages in a conda environment, and they mostly just work.
There are a <em>lot</em> of python packages on PyPI that are installable via pip that
I&rsquo;d like to use. constructor doesn&rsquo;t support bundling these, which is entirely
fair! <a href="https://github.com/conda/constructor/pull/96">This PR</a> attempted something
here, but was rejected.</p>
<p>So if I want to keep using packages that don&rsquo;t exist in <code>conda-forge</code> yet but
do exist in pip, I would have to make sure these packages and all their dependencies
exist as conda packages too. This would be fine if constructor was giving
me enough value to justify it, but right now it is not. I&rsquo;ve also tried going
down a similar road (<em>cough</em> debian <em>cough</em>) and did not want to do that again :)</p>
<h2 id="awkward-post-installbash">Awkward <code>post-install.bash</code></h2>
<p>I wanted to set up systemd units post install. Right off the bat this should
have made me realize conda constructor was not the right tool for the job :D
The only injected environment variable is <code>$PREFIX</code>, which is not super helpful
if you wanna do stuff like &lsquo;copy this systemd unit file somewhere&rsquo;. I ended up
writing a small python module that does all these things, and calling it from
post-install. However, even then I couldn&rsquo;t pass any environment variables to it,
making testing / CI hard.</p>
<h2 id="current-solution">Current solution</h2>
<p>Currently, we have a <a href="https://github.com/yuvipanda/the-littlest-jupyterhub/blob/9cc05a9d627515a01b68e244a970079481be7d9e/installer/install.bash">bootstrap script</a>
that downloads miniconda, &amp; bootstraps from there to a full JupyterHub install.
Things like systemd units &amp; sudo rules are managed by a <a href="https://github.com/yuvipanda/the-littlest-jupyterhub/tree/9cc05a9d627515a01b68e244a970079481be7d9e/tljh">python module</a>
that is called from the bootstrap script.</p>

    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/the-littlest-jupyterhub/">The Littlest Jupyterhub</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2018-06-18 </span>
      <div class="post-category">
          <a href="/categories/jupyter/"> jupyter </a>
          <a href="/categories/project-ideas/"> project-ideas </a>
          </div>
        <span class="more-meta"> 803 words </span>
        <span class="more-meta"> 4 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p>This idea comes from brainstorming along with <a href="https://lindseyjh.ca/">Lindsey
Heagy</a>, <a href="https://www.willingconsulting.com/">Carol
Willing</a>, <a href="https://github.com/betatim">Tim
Head</a> &amp; <a href="https://github.com/bollwyvl">Nick
Bollweg</a> at the Jupyter Team Meeting 2018. Most
of the good ideas are theirs! The name is inspired by <a href="https://en.wikipedia.org/wiki/The_Littlest_Hobo">one of favorite TV
series</a> of one of my
favorite people.</p>
<p>I really love the idea of <a href="https://github.com/jupyterhub/jupyterhub">JupyterHub</a> distributions - opinionated combination
of components that target a specific use case. The <a href="https://z2jh.jupyter.org">Zero to JupyterHub</a>
distribution is awesome &amp; works for most people. However, it requires
<a href="https://kubernetes.io">Kubernetes</a> - a distributed system with inherent complexities that is not
worth it below a certain threshold.</p>
<p>This blog post lays out ideas for implementing a simpler, smaller distribution called
<em>The Littlest JupyterHub</em>. The Littlest JupyterHub serves <a href="https://en.wikipedia.org/wiki/Long_tail">the long tail</a> of potential JupyterHub users
who have the following needs only.</p>
<ol>
<li>Support a very small number of students (around 20–30, maybe 50)</li>
<li>Run on only one node, either <a href="http://digitalocean.com/">a cheap VPS</a> or a
VM on their <a href="https://cloud.google.com">favorite cloud provider</a></li>
<li>Provide the same environment for all students</li>
<li>Allow the instructor / admin to easily modify the environment for students with no specialized knowledge</li>
<li>Be extremely low maintenance once set up &amp; easily fixable when it breaks</li>
<li>Allow easy upgrades</li>
<li>Enforce memory / CPU limits for students</li>
</ol>
<p>The target audience is primarily educators teaching small classes with
Jupyter Notebooks. It should be an extremely focused distribution, with new
feature requests facing higher scrutiny than usual. It has a legitimate
chance of actually reaching 1.0 &amp; being stable, requiring minimal ongoing
upgrades!</p>
<h2 id="jupyterhub-setup">JupyterHub setup</h2>
<p>JupyterHub +
<a href="https://github.com/jupyterhub/configurable-http-proxy">ConfigurableHTTPProxy</a>
run as standard <a href="https://www.freedesktop.org/software/systemd/man/systemd.service.html">systemd services</a>.
<a href="https://github.com/jupyterhub/systemdspawner">Systemd spawner is used</a> - it is lightweight, allows JupyterHub
restarts without killing user servers &amp; provides CPU / memory isolation.</p>
<p>Something like <a href="https://github.com/yuvipanda/jupyterhub-firstuseauthenticator">First Use
Authenticator</a></p>
<ul>
<li>a user whitelist might be good enough for a large number of users. New
authenticators are added whenever users ask for them.</li>
</ul>
<p>The JupyterHub system is in its own root owned conda environment or
virtualenv, to prevent accidental damage from users.</p>
<h2 id="user-environment">User environment</h2>
<p>There is a single
conda environment shared by all the users. JupyterHub admins have
write access to this environment, and everyone else has read access. Admins
can install new libraries for all users with conda/pip. No extra steps
needed, and you can do this from inside JupyterHub without needing to ssh.</p>
<p>Each user gets their own home directory, and can install packages there if
they wish. systemdspawner puts each user server in a systemd service, and
provides <a href="https://www.freedesktop.org/software/systemd/man/systemd.resource-control.html">fine grained
control</a>
over memory &amp; cpu usage. Users also get their own system user, providing an
additional layer of security &amp; standardized home directory locations.</p>
<h2 id="configuration">Configuration</h2>
<p><a href="http://yaml.org/">YAML</a> is used for config - it is the
least bad of all the currently available languages, IMO. Ideally, something
like the <a href="https://www.sudo.ws/man/1.8.17/visudo.man.html"><code>visudo</code></a> command
would exist for editing &amp; applying this config. It&rsquo;ll
open the config file in an editor, allow users to edit it, and apply it only
if it is valid. Advanced users can sidestep this and edit files directly. The
YAML file is read and processed directly in <code>jupyterhub_config.py</code>. This
simplifies things &amp; gives us fewer things to break.</p>
<h2 id="upgrading-the-distribution">Upgrading the distribution</h2>
<p>Backwards compatible upgrading will be supported across one
minor version only - so you can go from 0.7 to 0.8, but not 0.9. Upgrades
should not cause outages.</p>
<h2 id="installation-mechanism">Installation mechanism</h2>
<p>Users run a command on a fresh server to install this distribution. This could use
conda constructor (thanks to Nick Bollweig &amp; <a href="http://matthewrocklin.com/">Matt
Rocklin</a> for convincing me!)
or debian packages (with fpm or dh-virtualenv). The user environments will be
<a href="https://conda.io/">conda environments</a>.</p>
<p>A <code>curl &lt;some-url&gt; | sudo bash</code> command is available in a
nice looking website for the distribution that users can copy paste into
their fresh VM. This website also has instructions for creating a fresh VM in
popular cloud providers &amp; VPS providers.</p>
<h2 id="debuggability">Debuggability</h2>
<p>All systems exist in a partially degraded state all the time. Good systems
self-heal &amp; continue to run as well as they can. When they can&rsquo;t, they break
cleanly in known ways. They are observable enough to debug the issues that
cause 80% of the problems.</p>
<p>The Littlest JupyterHub should be a good system. Systemd captures
logs from JupyterHub, user servers &amp; the proxy. Strong validation of the
config file catches fatal misconfigurations. Reboots actually fix most issues
and never make anything worse. Screwed up user environments are recoverable.</p>
<p>We&rsquo;ll discover how this breaks as users of varying skill levels use it, and
update our tooling accordingly.</p>
<h2 id="but-no-docker">But, No Docker?</h2>
<p>Docker has been explicitly excluded from this tech stack. Building custom
docker images &amp; dealing with registries is too complex most educators. A good
distribution embraces its constraints &amp; does well!</p>
<h2 id="contribute">Contribute</h2>
<p>Are you a person who would use a distribution like this? We would love to
hear from you! Make an issue <a href="https://github.com/yuvipanda/the-littlest-jupyterhub">on GitHub</a>,
<a href="https://twitter.com/yuvipanda">tweet at me</a>, or send me <a href="mailto:yuvipanda@gmail.com">an email</a>.</p>

    </div>
  </div>
</article>

    <article class="post">
  <header class="post-header">
    <h1 class="post-title"><a class="post-link" href="/post/kubectl-rbac/">Kubectl verbose logging tricks</a></h1>
    <div class="post-meta">
      <span class="post-time"> 2018-01-11 </span>
      <div class="post-category">
          <a href="/categories/kubernetes/"> kubernetes </a>
          <a href="/categories/code/"> code </a>
          </div>
        <span class="more-meta"> 301 words </span>
        <span class="more-meta"> 2 mins read </span>
    </div>
  </header>
  
  <div class="post-content">
    <div class="post-summary">
      <p>Recently I had to write some code that had to call the kubernetes API directly,
without any language wrappers. While there is pretty good <a href="https://kubernetes.io/docs/reference/">reference docs</a>,
I didn&rsquo;t want to go and construct all the JSON manually in my programming language.</p>
<p>I discovered that <code>kubectl</code>'s <code>-v</code> parameter is very useful for this! With this,
I can do the following:</p>
<ol>
<li>Perform the actions I need to perform with just <code>kubectl</code> commands</li>
<li>Pass <code>-v=8</code> to kubectl when doing this, and this will print all the HTTP traffic
(requests and responses!) in an easy to read way</li>
<li>Copy paste the JSON requests and template them as needed!</li>
</ol>
<p>This was very useful! The fact you can see the response bodies is also nice,
since it gives you a good intuition of how to handle this in your own code.</p>
<p>If you&rsquo;re shelling out to <code>kubectl</code> directly in your code (for some reason!),
you can also use this to figure out all the RBAC rules your code would need. For
example, if I&rsquo;m going to run the following in my script:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl get node
</code></pre></td></tr></table>
</div>
</div><p>and need to figure out which RBAC rules are needed for this, I can run:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">kubectl -v<span class="o">=</span><span class="m">8</span> get node 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">|</span> grep -P <span class="s1">&#39;GET|POST|DELETE|PATCH|PUT&#39;</span>
</code></pre></td></tr></table>
</div>
</div><p>This should list all the API requests the code is making, making it easier
to figure out what rules are needed.</p>
<p>Note that you might have to <code>rm -rf ~/.kube/cache</code> to &lsquo;really&rsquo; get the
full API requests list, since <code>kubectl</code> caches a bunch of API autodiscovery.
The minimum RBAC for kubectl is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="k">kind</span><span class="p">:</span><span class="w"> </span>ClusterRole<span class="w">
</span><span class="w"></span><span class="k">apiVersion</span><span class="p">:</span><span class="w"> </span>rbac.authorization.k8s.io/v1beta1<span class="w">
</span><span class="w"></span><span class="k">metadata</span><span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="k">name</span><span class="p">:</span><span class="w"> </span>kubectl-minimum<span class="w">
</span><span class="w"></span><span class="k">rules</span><span class="p">:</span><span class="w">
</span><span class="w"></span>- <span class="k">nonResourceURLs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;/api&#34;</span><span class="p">,</span><span class="w"> </span><span class="s2">&#34;/apis/*&#34;</span><span class="p">]</span><span class="w">
</span><span class="w">  </span><span class="k">verbs</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&#34;get&#34;</span><span class="p">]</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><p>You will need to add additional rules for the specific commands you
want to execute.</p>
<p><strong>More Kubectl Tips</strong></p>
<ol start="0">
<li><a href="https://schd.ws/hosted_files/kccncna17/de/Stupid%20Kubectl%20Tricks.pdf">Slides from the &lsquo;Stupid Kubectl Tricks&rsquo; KubeCon talk</a></li>
<li><a href="https://coreos.com/blog/kubectl-tips-and-tricks">On the CoreOS blog</a></li>
<li><a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/">Terse but useful official documentation</a></li>
</ol>

    </div>
  </div>
</article>

    </section>
  
  <nav class="pagination">
    
    <a class="next" href="/page/2/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
  </nav>
        </div>
        

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="http://localhost:1313" class="iconfont icon--pocket" title="-pocket"></a>
      <a href="mailto:yuvipanda@gmail.com" class="iconfont icon-email" title="email"></a>
      <a href="https://twitter.com/yuvipanda" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://github.com/yuvipanda" class="iconfont icon-github" title="github"></a>
  <a href="http://words.yuvi.in/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2005 - 
    2020
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Yuvi Panda</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.d7b7ada643c9c1a983026e177f141f7363b4640d619caf01d8831a6718cd44ea.js"></script>
  <script type="text/javascript">
    window.MathJax = {
      showProcessingMessages: false,
      messageStyle: 'none'
    };
  </script>
  <script async src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"  integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>








</body>
</html>
